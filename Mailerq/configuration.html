
<h1 id="Top">Configuration of MailerQ</h1>
<p>
    MailerQ can be configured, using the config file that can be found at
    “/etc/mailerq/config.txt”. The "config.txt" file holds configuration
    options for the connection to RabbitMQ, storage engine (Couchbase, MongoDB,
    MySQL, SQLite or PostgreSQL) and database (MySQL, SQLite or PostgreSQL)
    and other options for MailerQ itself.
</p>
<h2 id="Rabbit">RabbitMQ configuration options</h2>
<p>
    MailerQ loads all email meta data from a RabbitMQ message queue,
    so make sure that RabbitMQ is running when you use the MTA.
    The address and login data to access the message queues can be set
    in the following way. These setting should be the same as your RabbitMQ
    settings that you configured yourself.
</p>
<ul>
    <li><strong>rabbitmq-host:</strong> &lt;hostname&gt; -
        hostname of your RabbitMQ server. If you have a cluster
        of RabbitMQ nodes, you can enter multiple hostnames, delimted
        by a comma (host1,host2,host3...).
    </li>
    <li><strong>rabbitmq-user:</strong> &lt;username&gt; -
        user name for RabbitMQ.
    </li>
    <li><strong>rabbitmq-password:</strong> &lt;password&gt; -
        password for RabbitMQ.
    </li>
    <li><strong>rabbitmq-vhost:</strong> &lt;vhost&gt; -
        the RabbitMQ environment that MailerQ may use.
    </li>
    <li><strong>rabbitmq-exchange:</strong> &lt;exchange&gt;
        the name of the exchange in RabbitMQ that MailerQ uses to publish
        all messages to. If not explicitly set, MailerQ uses an exchange
        with the name "mailerq".
    </li>
    <li><strong>rabbitmq-outbox:</strong> &lt;queue name&gt; -
        outbox message queue. All outgoing messages are loaded from
        here. If the outbox queue does not exist yet, MailerQ will
        create it.
    </li>
    <li><strong>rabbitmq-results:</strong> &lt;queue name&gt; -
        results message queue. All messages that were delivered or could
        not be delivered are posted here. If the result queue does not
        exist yet, MailerQ will create it. You can turn off results
        queue by leaving this field empty.
    </li>
    <li><strong>rabbitmq-success:</strong> &lt;queue name&gt; -
        success message queue. All messages that were successfully delivered are
        posted here. If the success queue does not exist yet, MailerQ
        will create it. You can turn off success queue by leaving this
        field empty.
    </li>
    <li><strong>rabbitmq-failure:</strong> &lt;queue name&gt; -
        failure message queue. All messages that could not be delivered
        are posted here. If the failure queue does not exist yet,
        MailerQ will create it. You can turn off failure queue by
        leaving this field empty.
    </li>
    <li><strong><a name="rabbitmq-inbox"></a>rabbitmq-inbox:</strong> &lt;queue name&gt; -
        inbox message queue. All messages that are received on the SMTP
        port are added to this inbox queue where you can pick them up for
        further processing. Most users set the inbox queue to the same value
        as the outbox queue. This will cause MailerQ to automatically forward
        incoming messages.
    </li>
    <li><strong>rabbitmq-retry:</strong> &lt;queue name&gt; -
        If a message can not immediately be delivered, or when it it greylisted and
        is going to be retries, it is published back to the outbox queue. MailerQ
        will later automatically pick it up from this outbox queue. If you want to
        process those intermediate messages too, you can also set a queue with the
        'rabbitmq-retry' queue. All copy of all failed deliveries that are going to
        be retried are posted there (as well as to the 'outbox' queue).
    </li>
    <li><strong>rabbitmq-persistent:</strong> &lt;0 or 1&gt; -
        Persistent message delivery mode. You can set this option to 0 to disable
        persistent delivery mode. It can be useful if your RabbitMQ server cannot
        keep up with the rate of publishing retries and delivery results. If you
        enable this feature, all messages published to RabbitMQ will be published
        <i>persistently</i>, meaning that they will be stored to disk by MailerQ.
    </li>
    <li><strong>rabbitmq-durable:</strong> &lt;0 or 1&gt; -
        MailerQ creates its own queues and exchanges in RabbitMQ when it starts.
        With this setting you can control whether these queues and exchanges should
        be durable or not.
    </li>
</ul>

<h2 id="cluster">Cluster configuration options</h2>
<p>
    It is possible to run multiple instances of MailerQ at the same time, each
    connected to a different outbox queue. These different instances communicate
    with each other using a special exchange in RabbitMQ, so that they can forward
    messages that are published to the wrong outbox to the right MailerQ instance.
</p>
<p>
    To use this feature, you should specify in the configuration file the address
    of the RabbitMQ server and the name of the exchange that is used for
    communicating between the MailerQ instances.
</p>
<ul>
    <li><strong>cluster-host:</strong> &lt;hostname&gt; -
        Hostname of the RabbitMQ server that is used for communicating between
        the running MailerQ instances.
    </li>
    <li><strong>cluster-user:</strong> &lt;username&gt; -
        User name for RabbitMQ.
    </li>
    <li><strong>cluster-password:</strong> &lt;password&gt; -
        Password for RabbitMQ.
    </li>
    <li><strong>cluster-vhost:</strong> &lt;username&gt; -
        The RabbitMQ environment that MailerQ uses for cluster communication.
    </li>
    <li><strong>cluster-exchange:</strong> &lt;username&gt; -
        Name of the exchange in RabbitMQ that is used for cluster communication.
    </li>
</ul>


<h2 id="Database">Database configuration options</h2>
<p>
    The configuration for the various domains - like the max delivery
    rate and max connect rate - is stored in a database. The address
    of this database is set in the config file and should match
    your database configuration.
</p>
<p>
    Using a database is optional. Without it, MailerQ will simply send
    e-mails using default settings, and it is not possible to set
    the delivery rates for specific domains.
</p>
<p>
   The MailerQ MTA supports a number of database engines: MySQL, SQLite and PostgreSQL.
   The SQLite is the simplest one and the easiest one to set up (you do not
   need a seperate database server for it). However, the other supported
   engines are faster and better suited for high performance servers.
</p>
<ul>
    <li><strong>database:</strong> &lt;database address&gt; -
        name of the MySQL database that MailerQ can use to get the mail
        sending settings. You will need to have a database in place
        already. The format for the database address is:

        <pre>
sqlite:///path/to/database/file
mysql://user:password@hostname/databasename
postgresql://user:password@hostname/databasename</pre>
    </li>
</ul>
<p>
    MailerQ automatically creates or alters missing or incomplete tables.
    If you use a MySQL or PostgreSQL database, you should ensure that
    the specified database is already created, and that MailerQ has
    enough privileges to create and modify tables. For a SQLite database
    you only have to make sure that the database file is writable.
</p>
<p>
    In normal operations you do not need to login to the database yourself
    and run any queries, but if you do like to access that data you are free
    to do so. MailerQ reloads data from the database every couple of minutes,
    so any changes you make will automatically come into effect without the
    need to restart the MTA.
</p>

<h2 id="Storage">Message store options</h2>
<p>
    Sometimes MailerQ needs to republish mails back into the message queue -
    for example when a message is greylisted and should be retried later.
    When this republishing is done a few times for a single delivery, it causes
    extra network traffic between MailerQ and RabbitMQ. This traffic can be
    large, especially if emails contain attachments and/or embedded content.
</p>
<p>
    To overcome this, MailerQ can be configured to store the full message bodies
    in a seperate storage system, and use RabbitMQ only for the email meta
    data (which is much smaller).
</p>
<p>
    You can use a number of different storage systems for this: Couchbase, MongoDB,
    Mysql, Sqlite and PostgreSQL. (Be aware that in practice it only makes sense
    to use Couchbase or MongoDB, because it can handle the required high loads. If
    you do not have a Couchbase or MongoDB server, you can better not set up a storage system
    and put the message bodies in RabbitMQ, than using one of the SQL alternatives).
</p>
<ul>
    <li><strong>storage:</strong> &lt;storage address&gt; -
        The address of a storage server can be specified as follows:
        <pre>
couchbase://password@hostname/bucketname
couchbase://password@host1;host2;host3/bucketname
mongo://hostname/database/collection
mongo://host1;host2;host3/replicaset/database/collection
sqlite:///path/to/database/file
mysql://user:password@hostname/databasename
postgresql://user:password@hostname/databasename</pre>
    </li>
</ul>
<p>
    If you have a cluster of couchbase or MongoDB servers, you can split the
    different hostname with semi colons (';'). For MongoDB you also need to
    specify the name of the replica set in the address if you have more than
    one server.
</p>
<p>
    This is an optional setting. If you leave it empty, the full message bodies
    are always kept in RabbitMQ. MailerQ will work just as well (even faster
    because no extra communication with the storage server is necessary), but
    the load on RabbitMQ and the network will be higher.
</p>
<p>
    We intend to add support for other key/value stores as well.
</p>

<h2 id="Retries">Automatic retry limit</h2>
<p>
    If, for one reason or another, a message could not immediately be delivered,
    the message is put back in the outbox message queue to be retried later.
</p>
<p>
    The interval between attempts grows with the number of attempts. The second
    attempt will be made only a few minutes after the first, the 10th or 20th
    attempt can even be many hours or days later. The default number of attempts
    and the amount of time spent retrying can both be set in the config file.
</p>
<ul>
    <li><strong>max-attempts:</strong> &lt;number of attempts&gt; -
    Maximum number of retry attempts. If delivery doesn't succeed in this number
    of attempts, it is marked as failed and no more delivery attempts will be taken.
    </li>
    <li><strong>max-deliver-time:</strong> &lt;delay in seconds from first attempt&gt; -
    Maximum time in which retry attempts are made. If delivery doesn't succeed
    during this time, it is marked as failed and will be no further attempts.
    </li>
</ul>

<h2 id="Normalize">Normalize line endings</h2>
<p>
    All lines in an email MIME message must be terminated with linefeed-newline (\r\n).
    If you use other line endings (for example only newlines, without the linefeeds)
    the mail might not be delivered and DKIM signing could fail.
</p>
<p>
    Normally, MailerQ trusts you to supply valid MIME messages, with valid line
    endings. However, if you want MailerQ to repair your messages if the line endings
    are incorrect, you can enable the following option.
</p>
<ul>
    <li><strong>normalize-mime:</strong> &lt;0|1&gt; -
        Let MailerQ normalize line endings to linefeed-newline
    </li>
</ul>


<h2 id="Domain">Domain limits</h2>
<p>
    MailerQ uses seperate throttle settings for individual domains. The
    maximum number of simultaneous connections, maximum number of messages
    per minute and maximum number of new connections per minute can all be
    set for specific domains. It is thus possible to have different limits
    for mails sent to GMAIL.COM and for mails to VERYSMALLCOMPANY.COM. All
    these settings can be configured using MailerQ's online management console.
</p>
<p>
    MailerQ always checks if there are domain specific settings stored
    in the database. If no specific settings can be found in the database,
    the server will rely on the defaults set in the configuration file.
    The following config file variables can be used to set these defaults.
</p>
<ul>
    <li><strong>domain-maxmessages:</strong> &lt;messages&gt; -
    default maximum amount of messages delivered per minute,
    set to '-1' for no limit. Only used for domains for which no other
    limit is set.
    </li>
    <li><strong>domain-maxconnects:</strong> &lt;connection attempts&gt; -
    the maximum number of connection attempts to make to a domain in
    one minute, set to '-1' for no limit. Only used for domains for which
    no other limit is set.
    </li>
    <li><strong>domain-maxconnections:</strong> &lt;connections&gt; -
    the maximum number of connections to a domain that can exist at
    the same time, set to '-1' for no limit. Only used for domains for which
    no other limit is set.
    </li>
    <li><strong>domain-maxqueue:</strong> &lt;length&gt; -
    the max number of messages that are kept in memory for this domain.
    Use '-1' for unlimited.
    </li>
</ul>

<h2 id="Ip">IP address limits</h2>
<p>
    Just like it is possible to set limits for a domain, it is also
    possible to set limits per IP address. The following variables can be
    used to limit the deliveries to IP addresses. The values for the IP limits
    in the "config.txt" file are the default values and can be overridden
    for specific domains in via the management console or in the database.
</p>
<ul>
    <li><strong>ip-maxmessages:</strong> &lt;messages&gt; -
        default maximum amount of messages delivered per
        minute, -1 for no limit. Only used for IP's linked to domains for
        which no other limit is set.
    </li>
    <li><strong>ip-maxconnects:</strong> &lt;connection attempts&gt; -
        the maximum number of connection attempts to make
        to an IP address in one minute, -1 for no limit. Only used for IP's
        linked to domains for which no other limit is set.
    </li>
    <li><strong>ip-maxconnections:</strong> &lt;connections&gt; -
        the  maximum number of connections that can exist
        at the same time to an IP address, -1 for no limit. Only used for
        IP's linked to domains for which no other limit is set.
    </li>
</ul>

<h2 id="Connection">Connection limits</h2>
<p>
    Each connection that is made with a remote server also has its
    limits, and just like the settings per domain and per IP address,
    these settings can also be configured for specific domains. The settings
    in the config file are the defaults in case no settings for a domain
    exist in the database.
</p>
<ul>
    <li><strong>connection-maxmessages:</strong> &lt;messages&gt; -
        this setting defines the maximum number of messages
        that are sent over a connection, before the connection
        is closed. When the maximum number of messages is
        reached, the connection is closed and subsequent
        messages are sent over a new connection. Set this value
        to -1 if there should be no limit.
    </li>
    <li><strong>connection-maxidle:</strong> &lt;miliseconds&gt; -
        this variable defines for what time in milliseconds
        a connection is kept open while it is idle. If two messages
        to the same domain are sent within the
        "connection-maxidle" time, they are sent over the
        same connection. If the time between the messages is
        greater than the "connection-maxidle" time, the
        connection closes and a new connection has to be
        opened before the message can be sent.
    </li>
    <li><strong>connection-secure:</strong> &lt;0 or 1&gt; -
        this value is either 1 or 0 and it tells MailerQ
        to try to use encrypted TLS connections to communicate
        with the remote server. Communication over TLS is
        slower than communicating over a normal unencrypted
        connection.
    </li>
</ul>

<h2 id="Threads">Number of threads</h2>
<p>
    MailerQ starts up multiple worker threads for various tasks.
    There is a thread for writing to the log file, a thread for
    loading messages from RabbitMQ, and a thread for writing them
    back to RabbitMQ, and special threads to communicate with the
    database and storage.
</p>
<p>
    Next to these threads, MailerQ starts additional threads for
    sending out SMTP messages. The number of SMTP threads to start can
    be configured with the max-threads variable. On a dedicated machine
    it is wise to set this to a value close to the number of cores
    in the machine (minus about five for the threads mentioned above).
</p>
<ul>
    <li><strong>max-threads:</strong> &lt;threads&gt; -
        number of worker threads for sending out mail and doing
        the SMTP communication.
    </li>
</ul>

<h2 id="Connections">Number of connections in total</h2>
<p>
    To prevent the server from running out of file descriptors, it only
    opens a certain number of connections at the same time. Make sure
    that this variable does not exceed the limit for the number of
    open files! To let everthing work smoothly, leave at least 100 file
    descriptors to the application that can be used for communication
    with databases, logfiles, message queues and dns servers.
</p>
<ul>
    <li><strong>max-connections:</strong> &lt;connections&gt; -
        the maximum number of connections at the same time
    </li>
</ul>

<h2 id="Memory">Memory usage configuration</h2>
<p>
    To prevent the server from running out of memory, you can limit
    the number of messages loaded into memory.
</p>
<ul>
    <li><strong>max-messages:</strong> &lt;messages&gt; -
        this is the number of messages that MailerQ loads from
        RabbitMQ and stores in internal in-memory queues.
    </li>
    <li><strong>max-queues:</strong> &lt;queues&gt; -
        this is the maximum number of queues which MailerQ is allowed
        to keep in memory, excluding the temporary queues.
    </li>
    <li><strong>max-memory:</strong> &lt;memory&gt; -
        max memory to use by MailerQ. This setting can be specified
        in GB or MB (for example '16GB' or '512MB'). To set it to
        unlimited leave the value empty.
    </li>
</ul>
<p>
    When the max memory limit is reached, MailerQ stops loading
    messages from the message queue until more memory is available.
</p>

<h2 id="Management">Management console</h2>
<p>
    MailerQ opens a web port that can be used for monitoring the
    application. Go with your browser to http://your-server-name:port
    to access this management console.
</p>
<ul>
    <li><strong>www-ip:</strong> &lt;ip address&gt; -
        by default, the MailerQ management console can be accessed via
        all the IP addresses that are available on the server. If you
        only want to use a single IP, you can use this setting.
    </li>
    <li><strong>www-port:</strong> &lt;port&gt; -
        specific port opened to your management console .
    </li>
    <li><strong>www-host:</strong> &lt;hostname&gt; -
        MailerQ automatically detects its hostname by doing a reverse DNS
        lookup. If you want to use a different host instead, you can use
        this variable.
    </li>
    <li><strong>www-dir:</strong> &lt;path to 'www' dir&gt; -
        directory holding the static content (html, javascript, images,
        css) of the admin console.
    </li>
    <li><strong>www-password:</strong> &lt;password&gt; -
        password you want to use to login into the MailerQ management console.
        Leave this empty if you do not want to use a password for the management
        console. Make sure to install a firewall so that the web interface
        can only accessed by you - especially if you do not use a password.
    </li>
</ul>

<h2 id="Smtp">SMTP server</h2>
<p>
    MailerQ can open a SMTP port to accept incoming emails. All mails
    that are received on the SMTP port will automatically be published on
    the <a href="/documentation/configuration/#rabbitmq-inbox" title="inbox queue">inbox queue</a>.
    If this inbox queue is set to the same value as the outbox queue
    (which most users do), MailerQ automatically forwards all received messages.
</p>
<p>
    The recommended SMTP port is 25. To open this port however, MailerQ needs
    to be started with root privileges. After the port is opened, MailerQ
    changes its identity to a different (and safer) user.
</p>
<p>
    Be aware that by opening the SMTP port you might create an open SMTP proxy
    that the world can use for sending out spam. It therefore is wise to
    configure your firewall to only allow access from trusted hosts.
    The smtp-range setting can be used to limit access from specific IP
    addresses. Connections from other sources are blocked. The IP range must
    be set in <a href="http://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" target="_blank" rel="nofollow">CIDR notation</a>.
</p>
<p>
    Besides limiting the IP addresses that are able to deliver mail to
    MailerQ through the SMTP port, authentication can also be required
    by setting the smtp-username and smtp-password options. By default
    these are empty, meaning no authentication is required.
</p>
<p>
    To protect the messages delivered from eavesdropping, TLS can be
    enabled by setting the smtp-certificate and smtp-key to the full path
    containing the certificate and private key, respectively.
</p>
<ul>
    <li><strong>smtp-ip:</strong> &lt;ip address&gt; - normally, MailerQ
        opens a socket that can be accessed via all the IP addresses that
        are available on the server. If MailerQ should only be accessible
        via a specific IP address, you can set that IP with this setting.
        Make sure the IP address is assigned to the server.
    </li>
    <li><strong>smtp-port:</strong> &lt;port number&gt; - number for the
        SMTP port. If this is a set to a value lower than 1024, MailerQ needs
        to be started by user root.
    </li>
    <li><strong>smtp-range:</strong> &lt;ip range&gt; - the IP range from
        which incomming connections are allowed in CIDR notation.
    </li>
    <li>
        <strong>smtp-username:</strong> &lt;username&gt; - the username
        clients have to authenticate for SMTP email delivery.
    </li>
    <li>
        <strong>smtp-password:</strong> &lt;password&gt; - the username
        clients have to authenticate for SMTP email delivery.
    </li>
    <li>
        <strong>smtp-certificate:</strong> &lt;filename&gt; - the full
        path and filename to the file containing the certificate
    </li>
    <li>
        <strong>smtp-key:</strong> &lt;filename&gt; - the full
        path and filename to the file containing the private key
    </li>
</ul>

<h2 id="Logging">Logging</h2>
<p>
    All abnormal events are logged to the error logfile. This includes 
    failures like databases that are suddenly offline, or RabbitMQ
    connections that are lost. The name and error of the error log file
    can be set with the error-log setting.
</p>
<ul>
    <li><strong>error-log:</strong> &lt;filename&gt; -
        filename to which errors are logged. The file must of course be
        writable for MailerQ.
    </li>
</ul>    
<p>
    MailerQ also create logfiles for all delivery attempts and for all
    downloads. Every time that MailerQ tries to send out an email, it
    writes a line to the send log. When MailerQ downloads a file from the
    internet (for example an image or an RSS feed) it logs this in
    the downloads log.
</p>
<p>
    With the following settings you can specify to which directory the
    logs should be written, the name of the log files (you specify a prefix,
    MailerQ automatically rotates the log files, and appends a number to 
    prefix), and the maximum size of a log file before MailerQ moves on
    to the next log file. The number of log files that MailerQ keeps on
    disk can be limited by setting the 'history' option.
</p>
<ul>
    <li><strong>send-log-directory:</strong> &lt;directory&gt; -
        directory where logfiles with send attempts are stored. 
        The directory must be writable for MailerQ.
    </li>
    <li><strong>send-log-prefix:</strong> &lt;prefix&gt; -
        prefix of the name of the log files. Default is "attempts.log".
    </li>
    <li><strong>send-log-history</strong> &lt;number of files&gt; -
        this option holds the number of old delivery logfiles to keep on
        disk before oldest files are removed.
    </li>
    <li><strong>send-log-maxsize</strong> &lt;size&gt; -
        Maximum size of the log file, before MailerQ rotates the log files
        and continues writing to a new file. Default is "100MB".
    </li>
    <li><strong>send-log-maxage</strong> &lt;seconds&gt; -
        Maximum age of a log file. MailerQ rotates the log files when the
        current log file gets older than the specified number of seconds.
        If not set, log files are not rotated based on age.
    </li>
    <li><strong>download-log-directory:</strong> &lt;directory&gt; -
        directory where logfiles with downloads are stored. 
        The directory be writable for MailerQ.
    </li>
    <li><strong>download-log-prefix:</strong> &lt;prefix&gt; -
        prefix of the name of the log files. Default is "downloads.log".
    </li>
    <li><strong>download-log-history</strong> &lt;number of files&gt; -
        this option holds the number of old download logfiles to keep on
        disk before oldest files are removed.
    </li>
    <li><strong>download-log-maxsize</strong> &lt;size&gt; -
        Maximum size of the log file, before MailerQ rotates the log files
        and continues writing to a new file. Default is "100MB".
    </li>
    <li><strong>download-log-maxage</strong> &lt;seconds&gt; -
        Maximum age of a log file. MailerQ rotates the log files when the
        current log file gets older than the specified number of seconds.
        If not set, log files are not rotated based on age.
    </li>
</ul>
<h2 id="License">License</h2>
<p>
    To work properly, MailerQ needs a license file. The license file
    can be <a href="http://mailerq.com/product/license" title="MailerQ license">downloaded</a>
    from the MailerQ website. You can store the file anywhere on the file system.
</p>
<ul>
    <li><strong>license:</strong> &lt;path to license.txt&gt; -
        the path to the license file. The default path is
        "/etc/mailerq/license.txt"
    </li>
</ul>

<h2 id="User">User</h2>
<p>
    If you have configured MailerQ to use ports lower than 1024 (like port
    25 for SMTP and/or port 80 for the management console), the MTA must be
    started as user root. Once the ports have been opened, MailerQ changes
    its identity to the user set in the config file.
</p>
<ul>
    <li><strong>user:</strong> &lt;user name&gt; - the user name to change
        identify to after the SMTP and HTTP ports have been opened.
    </li>
</ul>

<h2 id="Plugins">Plugins</h2>
<p>
    Normally, MailerQ tries to load plugins from the default plugin directory, which is
    <code>/usr/share/mailerq/plugins</code>. However, if you want to load plugins from another directory instead,
    you can use the option below to specify the directory from which to load the plugins.
    Beware, MailerQ will silently continue when the specified directory can not be found,
    possibly causing plugins not to be loaded without a warning.
</p>
<ul>
    <li><strong>plugin-directory:</strong> &lt;path&gt; - The path to the directory
        where the plugins are located.
    </li>
</ul>


<h2 id="Smarthosts">Smarthosts</h2>
<p>
    When all messages need to be routed via an external mailserver, the smarthost
    option can be used. This global setting will cause all messages to be routed
    via the specified smarthost, where authentication is performed using the specified
    credentials.
</p>
<ul>
    <li><strong>smarthost:</strong> &lt;hostname&gt; -
        Hostname of the smarthost
    </li>
    <li><strong>smarthost-port:</strong> &lt;port&gt; - Port number
        on which to contact the smarthost. Defaults to 25 if omitted.
    </li>
    <li><strong>smarthost-username:</strong> &lt;username&gt; -
        Username to authenticate to the smarthost. Omit if no authentication is
        required.
    </li>
    <li><strong>smarthost-password:</strong> &lt;password&gt; - Password
        to authenticate to the smarthost. Omit if no authentication is needed.
    </li>
</ul>

<h2 id="DNS">DNS settings</h2>
<p>
    You can override the settings that MailerQ uses to communicate with DNS settings.
    By default, MailerQ does 4 attempts to resolve a domain, and uses a timeout
    of 5 seconds to wait for an answer before it proceeds to the next server to 
    resolve the domain. These settings can be changed.
</p>
<p>
    The first lookup is done using UDP. If the response from the DNS server is
    truncated because it does not fit in a UDP datagram, MailerQ opens a TCP
    connection to the same DNS server to repeat the request. You can also 
    modify this behavior and enforce that MailerQ only uses TCP, or only
    uses UDP.
</p>
<p>
    When MailerQ sets up an SMTP connection, it first sends out the "HELO" message as
    is required by the SMTP protocol. (In fact, it first tries the more modern "EHLO"
    command defined by the ESMTP protocol). With this HELO or EHLO message a hostname
    is sent to the remote server that identifies the sender. Normally, MailerQ
    automatically detects which hostname to use (it simply does a reverse DNS query).
</p>
<p>
    If you want to override this with different values you can add a helo map file in
    which you provide your own HELO hostnames.
</p>
<p>
    The file should contain IPs and hostnames in following format:
    <pre>
10.0.0.1 hostname1.example.com
10.0.0.2 hostname2.example.com
[...]
    </pre>
</p>
<ul>
    <li><strong>dns-timeout:</strong> &lt;timeout&gt;
        timeout in milliseconds before MailerQ proceeds to next DNS server. Default
        is 5000 milliseconds.
    </li>
</ul>
<ul>
    <li><strong>dns-attempts:</strong> &lt;attempts&gt;
        number of attempts before giving up, defaults to 4.
    </li>
</ul>
<ul>
    <li><strong>dns-force:</strong> "udp"|"tcp"
        the communication channel to use, either "udp" or "tcp". The default
        value is to use both.
    </li>
</ul>

<ul>
    <li><strong>dns-helofile:</strong> &lt;filename&gt;
        loaction of the file containing HELO map
    </li>
</ul>

<h2 id="Debug">Debugging</h2>
<p>
    When you're debugging or testing, you can force MailerQ to deliver
    all messages to a fixed IP address and port. You can for example use
    the <a href="http://www.postfix.org/smtp-sink.1.html">smtp-sink</a>
    program for catching all these dummy deliveries.
</p>
<p>
    It is recommended to only use this option for debugging; for other purposes
    such as routing all emails to a single external host the smarthost option
    should be utilized. This is because internally, MailerQ is still constructing
    queues and throttling domains, while the server for each domain is equal. With
    the smarthost option, these internal performance wastes are omitted and everything
    is routed directly to the external server, improving performance.
</p>
<ul>
    <li><strong>smtp-sink-ip:</strong> &lt;ip address&gt; - Debug/test
        IP address to deliver all outgoing emails to.
    </li>
    <li><strong>smtp-sink-port:</strong> &lt;port&gt; - Debug/test
        port number to deliver all outgoing emails to.
    </li>
    <li><strong>smtp-sink-username:</strong> &lt;username&gt; - Username to
        authenticate to the sink.
    </li>
    <li><strong>smtp-sink-password:</strong> &lt;password&gt; - Password to
        authenticate to the sink.
    </li>
</ul>

<h2 id="Lock">Lockfile</h2>
<p>
    To prevent that MailerQ starts more than once, MailerQ stores its
    process ID (pid) in a lockfile. The name and location of the lockfile
    can be set in the configuration file.
</p>
<ul>
    <li><strong>lock:</strong> &lt;filename&gt;
        location of the lock file. Default is "/tmp/mailerq.pid".
    </li>
</ul>
